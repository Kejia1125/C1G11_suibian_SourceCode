{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LENOVO/Downloads/smart-campus-monitor-app-draft%20%281%29/lib/ai-recommendations.ts"],"sourcesContent":["// AI-powered recommendations using OpenRouter with Mistral-7B\n// Falls back to rule-based system if AI fails\n\nimport type { EnergyWaste, TemperatureOptimization, ScheduleOptimization } from \"./energy\"\nimport type { WeatherData } from \"./weather\"\n\nexport interface AIRecommendation {\n  id: string\n  title: string\n  description: string\n  priority: \"high\" | \"medium\" | \"low\"\n  category: \"energy\" | \"temperature\" | \"scheduling\" | \"general\"\n  impact: string\n  savings?: number\n}\n\n// Rule-based recommendations as fallback\nexport function generateRuleBasedRecommendations(\n  energyWastes: EnergyWaste[],\n  tempOptimizations: TemperatureOptimization[],\n  scheduleOptimizations: ScheduleOptimization[],\n  weather: WeatherData,\n): AIRecommendation[] {\n  const recommendations: AIRecommendation[] = []\n\n  // Energy waste recommendations\n  energyWastes.slice(0, 3).forEach((waste, idx) => {\n    recommendations.push({\n      id: `energy-${idx}`,\n      title: `Reduce Energy Waste in ${waste.roomName}`,\n      description: `${waste.reason}. Currently wasting ${waste.wastedKwh} kWh (RM ${waste.wastedCost}/day).`,\n      priority: waste.wastePercentage > 30 ? \"high\" : \"medium\",\n      category: \"energy\",\n      impact: `Save RM ${(waste.wastedCost * 30).toFixed(2)}/month`,\n      savings: waste.wastedCost,\n    })\n  })\n\n  // Temperature recommendations\n  tempOptimizations.slice(0, 2).forEach((opt, idx) => {\n    recommendations.push({\n      id: `temp-${idx}`,\n      title: `Optimize AC in ${opt.roomName}`,\n      description: `${opt.reasoning}. Adjust from ${opt.currentTemp}°C to ${opt.recommendedTemp}°C.`,\n      priority: \"medium\",\n      category: \"temperature\",\n      impact: `Save approximately RM ${opt.potentialSavings}/day`,\n      savings: opt.potentialSavings,\n    })\n  })\n\n  // Schedule recommendations\n  scheduleOptimizations.slice(0, 2).forEach((sched, idx) => {\n    recommendations.push({\n      id: `schedule-${idx}`,\n      title: \"Optimize Room Allocation\",\n      description: sched.suggestion,\n      priority: sched.priority,\n      category: \"scheduling\",\n      impact: sched.impact,\n      savings: sched.estimatedSavings,\n    })\n  })\n\n  // Weather-based recommendation\n  if (weather.temperature > 30) {\n    recommendations.push({\n      id: \"weather-1\",\n      title: \"Hot Weather Alert\",\n      description: `Outdoor temperature is ${weather.temperature}°C. Consider pre-cooling rooms before peak occupancy hours.`,\n      priority: \"medium\",\n      category: \"temperature\",\n      impact: \"Reduce peak AC load and improve comfort\",\n    })\n  }\n\n  return recommendations.slice(0, 6) // Return top 6\n}\n\n// AI-powered recommendations using OpenRouter\nexport async function generateAIRecommendations(\n  energyWastes: EnergyWaste[],\n  tempOptimizations: TemperatureOptimization[],\n  scheduleOptimizations: ScheduleOptimization[],\n  weather: WeatherData,\n  totalDailyWaste: number,\n): Promise<AIRecommendation[]> {\n  const apiKey = process.env.OPENROUTER_API_KEY\n  \n  if (!apiKey) {\n    console.log(\"[v0] No OpenRouter API key found, using rule-based recommendations\")\n    return generateRuleBasedRecommendations(energyWastes, tempOptimizations, scheduleOptimizations, weather)\n  }\n\n  // 1. IMPROVED PROMPT: Strong negative constraints\n  const prompt = `You are an energy management AI. Analyze the data and provide 5-6 actionable recommendations.\n\nCurrent Situation:\n- Daily energy waste: RM ${totalDailyWaste.toFixed(2)}\n- Outdoor temperature: ${weather.temperature}°C\n- Weather: ${weather.description}\n\nIssues:\n${energyWastes.slice(0, 3).map((w) => `- ${w.roomName}: RM ${w.wastedCost}/day - ${w.reason}`).join(\"\\n\")}\n${tempOptimizations.slice(0, 2).map((t) => `- ${t.roomName}: ${t.reasoning}`).join(\"\\n\")}\n${scheduleOptimizations.slice(0, 2).map((s) => `- ${s.suggestion}`).join(\"\\n\")}\n\nCRITICAL INSTRUCTIONS:\n1. Return ONLY a raw JSON array.\n2. Start your response IMMEDIATELY with the character '['.\n3. Do NOT include markdown formatting (like \\`\\`\\`json).\n4. Do NOT include system tags like [B_INST], [/INST], or <s>.\n5. Do NOT include any introductory text like \"Here are the recommendations\".\n\nRequired JSON Format:\n[\n  {\n    \"title\": \"Title\",\n    \"description\": \"Explanation\",\n    \"priority\": \"high\",\n    \"category\": \"energy\",\n    \"impact\": \"Outcome\",\n    \"savings\": 0.0\n  }\n]`\n\n  // 2. RETRY LOGIC: Handle empty responses from free-tier models\n  const MAX_RETRIES = 3;\n  \n  for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {\n    try {\n      console.log(`[v0] AI Attempt ${attempt}/${MAX_RETRIES}...`);\n      \n      const response = await fetch(\"https://openrouter.ai/api/v1/chat/completions\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${apiKey}`,\n          \"HTTP-Referer\": \"https://smartcampus.example.com\",\n          \"X-Title\": \"SmartCampus Monitor\",\n        },\n        body: JSON.stringify({\n          model: \"mistralai/mistral-7b-instruct:free\",\n          messages: [{ role: \"user\", content: prompt }],\n          temperature: 0.7,\n          max_tokens: 1000,\n        }),\n      })\n\n      if (!response.ok) {\n        throw new Error(`API returned ${response.status}`);\n      }\n\n      const data = await response.json()\n      const aiResponse = data.choices[0]?.message?.content\n\n      // Check for empty/useless responses (the \"3 token\" bug)\n      if (!aiResponse || aiResponse.trim().length < 10) {\n        console.warn(`[v0] Attempt ${attempt} failed: AI returned empty response.`);\n        if (attempt === MAX_RETRIES) throw new Error(\"Empty response after retries\");\n        continue;\n      }\n\n      console.log(\"[v0] Raw AI response:\", aiResponse)\n\n      // 3. ROBUST PARSING LOGIC\n      let cleanedResponse = aiResponse;\n\n      // First, strip known \"leakage\" tags explicitly\n      cleanedResponse = cleanedResponse\n          .replace(/\\[\\/?B_INST\\]/g, \"\") // Removes [B_INST] and [/B_INST]\n          .replace(/\\[\\/?INST\\]/g, \"\")   // Removes [INST] and [/INST]\n          .replace(/<s>/g, \"\")           // Removes <s>\n          .replace(/<\\/s>/g, \"\");        // Removes </s>\n\n      // Second, find the JSON array boundaries\n      const firstBracket = cleanedResponse.indexOf('[');\n      const lastBracket = cleanedResponse.lastIndexOf(']');\n\n      if (firstBracket !== -1 && lastBracket !== -1) {\n        cleanedResponse = cleanedResponse.substring(firstBracket, lastBracket + 1);\n      } else {\n        // Fallback cleanup if brackets aren't clear\n        cleanedResponse = cleanedResponse\n            .replace(/```json/g, \"\")\n            .replace(/```/g, \"\")\n            .trim();\n      }\n\n      console.log(\"[v0] Cleaned AI response for parsing:\", cleanedResponse)\n\n      const recommendations = JSON.parse(cleanedResponse)\n      \n      return recommendations.map((rec: any, idx: number) => ({\n        id: `ai-${idx}`,\n        title: rec.title,\n        description: rec.description,\n        priority: rec.priority || \"medium\",\n        category: rec.category || \"general\",\n        impact: rec.impact,\n        savings: rec.savings,\n      }))\n\n    } catch (error) {\n      console.error(`[v0] Error on attempt ${attempt}:`, error);\n      \n      // If this was the last attempt, fall back to rules\n      if (attempt === MAX_RETRIES) {\n        console.log(\"[v0] All AI attempts failed. Falling back to rule-based system.\")\n        return generateRuleBasedRecommendations(energyWastes, tempOptimizations, scheduleOptimizations, weather)\n      }\n    }\n  }\n\n  return generateRuleBasedRecommendations(energyWastes, tempOptimizations, scheduleOptimizations, weather)\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LENOVO/Downloads/smart-campus-monitor-app-draft%20%281%29/lib/energy.ts"],"sourcesContent":["// Energy waste analysis and cost calculation utilities\n\nexport interface EnergyData {\n  roomId: string\n  roomName: string\n  powerUsage: number // kWh\n  occupancyScore: number\n  temperature: number\n  outdoorTemp: number\n  capacity: number\n  actualOccupants: number\n  scheduledHours: number\n  roomType: \"classroom\" | \"lab\" | \"library\" | \"meeting\"\n}\n\nexport interface EnergyWaste {\n  roomId: string\n  roomName: string\n  wastedKwh: number\n  wastedCost: number // in RM\n  wastePercentage: number\n  reason: string\n}\n\nexport interface CostAnalysis {\n  currentCost: number\n  optimizedCost: number\n  potentialSavings: number\n  dailyWaste: number\n  monthlyProjection: number\n}\n\n// TNB tariff rates (simplified - RM per kWh)\nconst TNB_RATE = 0.467 // Average commercial rate\n\n// Calculate baseline power for room type when empty\nfunction getBaselinePower(roomType: string): number {\n  switch (roomType) {\n    case \"classroom\":\n      return 2 // kWh when empty\n    case \"lab\":\n      return 5 // Higher due to equipment\n    case \"library\":\n      return 3\n    case \"meeting\":\n      return 1.5\n    default:\n      return 2\n  }\n}\n\n// Calculate expected power based on occupancy\nfunction getExpectedPower(roomType: string, occupancyScore: number, capacity: number): number {\n  const baseline = getBaselinePower(roomType)\n  const maxPower = capacity * 0.15 // Rough estimate: 150W per person\n  return baseline + maxPower * occupancyScore\n}\n\n// Analyze energy waste for a single room\nexport function analyzeEnergyWaste(data: EnergyData): EnergyWaste | null {\n  const expectedPower = getExpectedPower(data.roomType, data.occupancyScore, data.capacity)\n  const wastedKwh = Math.max(0, data.powerUsage - expectedPower)\n\n  // Only flag if waste is significant (> 10%)\n  if (wastedKwh < expectedPower * 0.1) {\n    return null\n  }\n\n  const wastePercentage = (wastedKwh / data.powerUsage) * 100\n  const wastedCost = wastedKwh * TNB_RATE\n\n  let reason = \"\"\n  if (data.occupancyScore < 0.3 && data.powerUsage > 15) {\n    reason = \"High power usage in empty/low occupancy room\"\n  } else if (data.temperature < 22 && data.occupancyScore < 0.5) {\n    reason = \"AC overcooling with low occupancy\"\n  } else if (data.actualOccupants < data.capacity * 0.3 && data.powerUsage > expectedPower * 1.5) {\n    reason = \"Underutilized room with excessive power consumption\"\n  } else {\n    reason = \"Power usage exceeds expected baseline\"\n  }\n\n  return {\n    roomId: data.roomId,\n    roomName: data.roomName,\n    wastedKwh: Number.parseFloat(wastedKwh.toFixed(2)),\n    wastedCost: Number.parseFloat(wastedCost.toFixed(2)),\n    wastePercentage: Number.parseFloat(wastePercentage.toFixed(1)),\n    reason,\n  }\n}\n\n// Calculate cost analysis\nexport function calculateCostAnalysis(rooms: EnergyData[]): CostAnalysis {\n  let currentCost = 0\n  let optimizedCost = 0\n  let dailyWaste = 0\n\n  rooms.forEach((room) => {\n    const roomCost = room.powerUsage * TNB_RATE\n    currentCost += roomCost\n\n    const expectedPower = getExpectedPower(room.roomType, room.occupancyScore, room.capacity)\n    optimizedCost += expectedPower * TNB_RATE\n\n    const waste = analyzeEnergyWaste(room)\n    if (waste) {\n      dailyWaste += waste.wastedCost\n    }\n  })\n\n  return {\n    currentCost: Number.parseFloat(currentCost.toFixed(2)),\n    optimizedCost: Number.parseFloat(optimizedCost.toFixed(2)),\n    potentialSavings: Number.parseFloat((currentCost - optimizedCost).toFixed(2)),\n    dailyWaste: Number.parseFloat(dailyWaste.toFixed(2)),\n    monthlyProjection: Number.parseFloat((dailyWaste * 30).toFixed(2)),\n  }\n}\n\n// Generate temperature optimization suggestions\nexport interface TemperatureOptimization {\n  roomId: string\n  roomName: string\n  currentTemp: number\n  outdoorTemp: number\n  recommendedTemp: number\n  reasoning: string\n  potentialSavings: number\n}\n\nexport function optimizeTemperature(data: EnergyData): TemperatureOptimization | null {\n  const { roomId, roomName, temperature, outdoorTemp, occupancyScore } = data\n\n  let recommendedTemp = 24\n  let reasoning = \"\"\n  let potentialSavings = 0\n\n  // If room is empty or low occupancy\n  if (occupancyScore < 0.3) {\n    recommendedTemp = 26\n    reasoning = \"Low occupancy - increase AC temperature to save energy\"\n    potentialSavings = 1.2\n  }\n  // If outdoor is hot\n  else if (outdoorTemp > 32 && occupancyScore > 0.6) {\n    recommendedTemp = 25\n    reasoning = `Hot outdoor weather (${outdoorTemp}°C) - moderate AC to balance comfort and efficiency`\n    potentialSavings = 0.8\n  }\n  // If outdoor is mild\n  else if (outdoorTemp < 28) {\n    recommendedTemp = 25\n    reasoning = \"Mild outdoor temperature - reduce AC cooling\"\n    potentialSavings = 1.0\n  }\n  // High occupancy\n  else if (occupancyScore > 0.8) {\n    recommendedTemp = 23\n    reasoning = \"High occupancy - maintain cooler temperature for comfort\"\n    potentialSavings = 0\n  }\n\n  // Only return if there's a change and savings\n  if (Math.abs(temperature - recommendedTemp) < 1) {\n    return null\n  }\n\n  return {\n    roomId,\n    roomName,\n    currentTemp: temperature,\n    outdoorTemp,\n    recommendedTemp,\n    reasoning,\n    potentialSavings: Number.parseFloat(potentialSavings.toFixed(2)),\n  }\n}\n\n// Room scheduling optimization\nexport interface ScheduleOptimization {\n  suggestion: string\n  impact: string\n  estimatedSavings: number\n  priority: \"high\" | \"medium\" | \"low\"\n}\n\nexport function optimizeScheduling(rooms: EnergyData[]): ScheduleOptimization[] {\n  const suggestions: ScheduleOptimization[] = []\n\n  // Find underutilized large rooms\n  const underutilized = rooms.filter(\n    (r) => r.capacity > 30 && r.actualOccupants < r.capacity * 0.3 && r.actualOccupants > 0,\n  )\n\n  underutilized.forEach((room) => {\n    suggestions.push({\n      suggestion: `Move ${room.actualOccupants} students from ${room.roomName} (${room.capacity} seats) to a smaller room`,\n      impact: `Reduce AC and lighting load by consolidating students`,\n      estimatedSavings: Number.parseFloat((room.powerUsage * 0.4 * TNB_RATE).toFixed(2)),\n      priority: \"high\",\n    })\n  })\n\n  // Find rooms with low scheduled utilization\n  const lowUtilization = rooms.filter((r) => r.scheduledHours < 4)\n\n  if (lowUtilization.length >= 2) {\n    suggestions.push({\n      suggestion: `Consolidate ${lowUtilization.length} rooms with low utilization (< 4 hours/day)`,\n      impact: \"Reduce number of active rooms and AC zones\",\n      estimatedSavings: Number.parseFloat((lowUtilization.length * 15 * TNB_RATE).toFixed(2)),\n      priority: \"medium\",\n    })\n  }\n\n  // Suggest off-peak scheduling\n  suggestions.push({\n    suggestion: \"Schedule energy-intensive labs during cooler morning hours (8-10 AM)\",\n    impact: \"Reduce AC load during peak heat hours\",\n    estimatedSavings: 3.5,\n    priority: \"medium\",\n  })\n\n  return suggestions\n}\n\n// Calculate weekly waste trends from room data\nexport function calculateWeeklyWasteTrend(rooms: EnergyData[]): {\n  day: string\n  waste: number\n  cost: number\n}[] {\n  const days = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n  const weeklyData = []\n\n  for (let i = 0; i < days.length; i++) {\n    // Calculate total waste for each day based on room data\n    // Weekdays (Mon-Fri) have higher activity, weekends lower\n    const isWeekend = i >= 5\n    const activityMultiplier = isWeekend ? 0.3 : 1.0\n\n    // Add some variation for each day\n    const dayVariation = 1 + Math.sin(i * 0.7) * 0.15\n\n    let totalWaste = 0\n    let totalCost = 0\n\n    rooms.forEach((room) => {\n      const waste = analyzeEnergyWaste(room)\n      if (waste) {\n        const dailyWaste = waste.wastedKwh * activityMultiplier * dayVariation\n        totalWaste += dailyWaste\n        totalCost += dailyWaste * TNB_RATE\n      }\n    })\n\n    weeklyData.push({\n      day: days[i],\n      waste: Number.parseFloat(totalWaste.toFixed(2)),\n      cost: Number.parseFloat(totalCost.toFixed(2)),\n    })\n  }\n\n  return weeklyData\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 420, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LENOVO/Downloads/smart-campus-monitor-app-draft%20%281%29/lib/mock-data.ts"],"sourcesContent":["// Generate comprehensive dummy datasets for the SmartCampus Monitor\n\nimport type { EnergyData } from \"./energy\"\n\nexport function generateEnergyData(): EnergyData[] {\n  const rooms = [\n    {\n      roomId: \"A1\",\n      roomName: \"Tutorial Room 1\",\n      powerUsage: 35,\n      occupancyScore: 0.75,\n      temperature: 24,\n      outdoorTemp: 32,\n      capacity: 40,\n      actualOccupants: 30,\n      scheduledHours: 6,\n      roomType: \"classroom\" as const,\n    },\n    {\n      roomId: \"A2\",\n      roomName: \"Tutorial Room 2\",\n      powerUsage: 45,\n      occupancyScore: 0.15,\n      temperature: 22,\n      outdoorTemp: 32,\n      capacity: 40,\n      actualOccupants: 5,\n      scheduledHours: 3,\n      roomType: \"classroom\" as const,\n    },\n    {\n      roomId: \"LIB1\",\n      roomName: \"Library Area 1\",\n      powerUsage: 28,\n      occupancyScore: 0.45,\n      temperature: 23,\n      outdoorTemp: 32,\n      capacity: 60,\n      actualOccupants: 25,\n      scheduledHours: 10,\n      roomType: \"library\" as const,\n    },\n    {\n      roomId: \"LAB1\",\n      roomName: \"Computer Lab 1\",\n      powerUsage: 65,\n      occupancyScore: 0.85,\n      temperature: 23,\n      outdoorTemp: 32,\n      capacity: 40,\n      actualOccupants: 34,\n      scheduledHours: 8,\n      roomType: \"lab\" as const,\n    },\n    {\n      roomId: \"MTG1\",\n      roomName: \"Meeting Room 1\",\n      powerUsage: 50,\n      occupancyScore: 0.08,\n      temperature: 21,\n      outdoorTemp: 32,\n      capacity: 20,\n      actualOccupants: 2,\n      scheduledHours: 2,\n      roomType: \"meeting\" as const,\n    },\n    {\n      roomId: \"A3\",\n      roomName: \"Lecture Hall A\",\n      powerUsage: 55,\n      occupancyScore: 0.25,\n      temperature: 23,\n      outdoorTemp: 32,\n      capacity: 100,\n      actualOccupants: 25,\n      scheduledHours: 4,\n      roomType: \"classroom\" as const,\n    },\n  ]\n\n  return rooms\n}\n\n// Historical energy usage data for charts\nexport interface HistoricalEnergyData {\n  hour: string\n  power: number\n  occupancy: number\n  temperature: number\n}\n\nexport function generateHistoricalData(): HistoricalEnergyData[] {\n  const hours = [\"8AM\", \"10AM\", \"12PM\", \"2PM\", \"4PM\", \"6PM\"]\n  const data: HistoricalEnergyData[] = []\n\n  hours.forEach((hour, idx) => {\n    data.push({\n      hour,\n      power: 150 + idx * 30 - (idx > 4 ? 50 : 0), // Peak at 2-4PM\n      occupancy: 40 + idx * 15 - (idx > 4 ? 40 : 0), // Drop after 4PM\n      temperature: 28 + idx * 0.8 - (idx > 4 ? 2 : 0), // Cooler in evening\n    })\n  })\n\n  return data\n}\n\n// Weekly waste trend data\nexport interface WeeklyWasteData {\n  day: string\n  waste: number\n  cost: number\n}\n\n// Kept for backwards compatibility but returns empty array\nexport function generateWeeklyWaste(): WeeklyWasteData[] {\n  console.warn(\"[v0] generateWeeklyWaste is deprecated, use calculateWeeklyWasteTrend from energy.ts\")\n  return []\n}\n"],"names":[],"mappings":"AAAA,oEAAoE;;;;;;;;;AAI7D,SAAS;IACd,MAAM,QAAQ;QACZ;YACE,QAAQ;YACR,UAAU;YACV,YAAY;YACZ,gBAAgB;YAChB,aAAa;YACb,aAAa;YACb,UAAU;YACV,iBAAiB;YACjB,gBAAgB;YAChB,UAAU;QACZ;QACA;YACE,QAAQ;YACR,UAAU;YACV,YAAY;YACZ,gBAAgB;YAChB,aAAa;YACb,aAAa;YACb,UAAU;YACV,iBAAiB;YACjB,gBAAgB;YAChB,UAAU;QACZ;QACA;YACE,QAAQ;YACR,UAAU;YACV,YAAY;YACZ,gBAAgB;YAChB,aAAa;YACb,aAAa;YACb,UAAU;YACV,iBAAiB;YACjB,gBAAgB;YAChB,UAAU;QACZ;QACA;YACE,QAAQ;YACR,UAAU;YACV,YAAY;YACZ,gBAAgB;YAChB,aAAa;YACb,aAAa;YACb,UAAU;YACV,iBAAiB;YACjB,gBAAgB;YAChB,UAAU;QACZ;QACA;YACE,QAAQ;YACR,UAAU;YACV,YAAY;YACZ,gBAAgB;YAChB,aAAa;YACb,aAAa;YACb,UAAU;YACV,iBAAiB;YACjB,gBAAgB;YAChB,UAAU;QACZ;QACA;YACE,QAAQ;YACR,UAAU;YACV,YAAY;YACZ,gBAAgB;YAChB,aAAa;YACb,aAAa;YACb,UAAU;YACV,iBAAiB;YACjB,gBAAgB;YAChB,UAAU;QACZ;KACD;IAED,OAAO;AACT;AAUO,SAAS;IACd,MAAM,QAAQ;QAAC;QAAO;QAAQ;QAAQ;QAAO;QAAO;KAAM;IAC1D,MAAM,OAA+B,EAAE;IAEvC,MAAM,OAAO,CAAC,CAAC,MAAM;QACnB,KAAK,IAAI,CAAC;YACR;YACA,OAAO,MAAM,MAAM,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC;YACzC,WAAW,KAAK,MAAM,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC;YAC5C,aAAa,KAAK,MAAM,MAAM,CAAC,MAAM,IAAI,IAAI,CAAC;QAChD;IACF;IAEA,OAAO;AACT;AAUO,SAAS;IACd,QAAQ,IAAI,CAAC;IACb,OAAO,EAAE;AACX"}},
    {"offset": {"line": 534, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LENOVO/Downloads/smart-campus-monitor-app-draft%20%281%29/lib/weather.ts"],"sourcesContent":["// Weather API integration using Open-Meteo for hourly temperature\n\nexport interface HourlyWeatherData {\n  time: string[]\n  temperature: number[]\n  humidity: number[]\n}\n\nexport interface WeatherData {\n  temperature: number\n  humidity: number\n  description: string\n  location: string\n  timestamp: Date\n  hourly?: HourlyWeatherData\n}\n\nexport async function fetchWeatherData(latitude = 3.139, longitude = 101.6869): Promise<WeatherData> {\n  try {\n    const url = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,relative_humidity_2m,weather_code&hourly=temperature_2m,relative_humidity_2m&forecast_days=1&timezone=Asia/Singapore`\n\n    console.log(\"[v0] Fetching weather from Open-Meteo API...\")\n    console.log(\"[v0] Weather API URL:\", url)\n\n    const response = await fetch(url, {\n      method: \"GET\",\n      headers: {\n        Accept: \"application/json\",\n      },\n      cache: \"no-store\",\n    })\n\n    console.log(\"[v0] Weather API response status:\", response.status)\n\n    if (!response.ok) {\n      const errorText = await response.text()\n      console.error(\"[v0] Weather API error response:\", errorText)\n      throw new Error(`Weather API failed with status ${response.status}`)\n    }\n\n    const data = await response.json()\n    console.log(\"[v0] Weather API success! Temperature:\", data.current.temperature_2m)\n\n    return {\n      temperature: Math.round(data.current.temperature_2m),\n      humidity: data.current.relative_humidity_2m,\n      description: getWeatherDescription(data.current.weather_code),\n      location: \"Kuala Lumpur\",\n      timestamp: new Date(),\n      hourly: {\n        time: data.hourly.time,\n        temperature: data.hourly.temperature_2m.map((t: number) => Math.round(t)),\n        humidity: data.hourly.relative_humidity_2m,\n      },\n    }\n  } catch (error) {\n    console.error(\"[v0] Weather fetch error:\", error)\n    console.log(\"[v0] Using dummy weather data as fallback\")\n    // Return dummy data as fallback with hourly mock data\n    return generateDummyWeatherWithHourly()\n  }\n}\n\nfunction getWeatherDescription(code: number): string {\n  if (code === 0) return \"Clear sky\"\n  if (code <= 3) return \"Partly cloudy\"\n  if (code <= 48) return \"Foggy\"\n  if (code <= 67) return \"Rainy\"\n  if (code <= 77) return \"Snowy\"\n  if (code <= 82) return \"Rain showers\"\n  if (code <= 86) return \"Snow showers\"\n  return \"Thunderstorm\"\n}\n\nfunction generateDummyWeatherWithHourly(): WeatherData {\n  const now = new Date()\n  const hourlyTimes: string[] = []\n  const hourlyTemps: number[] = []\n  const hourlyHumidity: number[] = []\n\n  // Generate 24 hours of data\n  for (let i = 0; i < 24; i++) {\n    const hour = new Date(now)\n    hour.setHours(i, 0, 0, 0)\n    hourlyTimes.push(hour.toISOString())\n\n    // Temperature varies throughout the day (cooler at night, warmer during day)\n    const baseTemp = 28\n    const variation = Math.sin(((i - 6) * Math.PI) / 12) * 5\n    hourlyTemps.push(Math.round(baseTemp + variation))\n\n    // Humidity inversely related to temperature\n    hourlyHumidity.push(Math.round(75 - variation))\n  }\n\n  return {\n    temperature: hourlyTemps[now.getHours()],\n    humidity: hourlyHumidity[now.getHours()],\n    description: \"Partly cloudy\",\n    location: \"Kuala Lumpur\",\n    timestamp: now,\n    hourly: {\n      time: hourlyTimes,\n      temperature: hourlyTemps,\n      humidity: hourlyHumidity,\n    },\n  }\n}\n\nexport function generateDummyWeather(): WeatherData {\n  const temps = [28, 30, 32, 31, 33, 29]\n  const descriptions = [\"Clear sky\", \"Partly cloudy\", \"Sunny\", \"Hot and humid\"]\n  const randomTemp = temps[Math.floor(Math.random() * temps.length)]\n\n  return {\n    temperature: randomTemp,\n    humidity: 70 + Math.floor(Math.random() * 15),\n    description: descriptions[Math.floor(Math.random() * descriptions.length)],\n    location: \"Kuala Lumpur\",\n    timestamp: new Date(),\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 648, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LENOVO/Downloads/smart-campus-monitor-app-draft%20%281%29/app/api/ai-recommendations/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { generateAIRecommendations } from \"@/lib/ai-recommendations\"\nimport { analyzeEnergyWaste, optimizeTemperature, optimizeScheduling, calculateCostAnalysis } from \"@/lib/energy\"\nimport { generateEnergyData } from \"@/lib/mock-data\"\nimport { generateDummyWeather } from \"@/lib/weather\"\n\nexport async function GET() {\n  try {\n    // Get mock energy data\n    const energyData = generateEnergyData()\n\n    // Analyze energy waste\n    const energyWastes = energyData\n      .map((room) => analyzeEnergyWaste(room))\n      .filter((waste): waste is NonNullable<typeof waste> => waste !== null)\n      .sort((a, b) => b.wastedCost - a.wastedCost)\n\n    // Temperature optimizations\n    const tempOptimizations = energyData\n      .map((room) => optimizeTemperature(room))\n      .filter((opt): opt is NonNullable<typeof opt> => opt !== null)\n\n    // Schedule optimizations\n    const scheduleOptimizations = optimizeScheduling(energyData)\n\n    // Get weather data\n    const weather = generateDummyWeather()\n\n    // Calculate total waste\n    const costAnalysis = calculateCostAnalysis(energyData)\n\n    // Generate AI recommendations\n    const recommendations = await generateAIRecommendations(\n      energyWastes,\n      tempOptimizations,\n      scheduleOptimizations,\n      weather,\n      costAnalysis.dailyWaste,\n    )\n\n    return NextResponse.json({\n      recommendations,\n      energyWastes,\n      tempOptimizations,\n      scheduleOptimizations,\n      costAnalysis,\n      weather,\n    })\n  } catch (error) {\n    console.error(\"[v0] AI recommendations error:\", error)\n    return NextResponse.json({ error: \"Failed to generate recommendations\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEO,eAAe;IACpB,IAAI;QACF,uBAAuB;QACvB,MAAM,aAAa,IAAA,+MAAkB;QAErC,uBAAuB;QACvB,MAAM,eAAe,WAClB,GAAG,CAAC,CAAC,OAAS,IAAA,yMAAkB,EAAC,OACjC,MAAM,CAAC,CAAC,QAA8C,UAAU,MAChE,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,UAAU,GAAG,EAAE,UAAU;QAE7C,4BAA4B;QAC5B,MAAM,oBAAoB,WACvB,GAAG,CAAC,CAAC,OAAS,IAAA,0MAAmB,EAAC,OAClC,MAAM,CAAC,CAAC,MAAwC,QAAQ;QAE3D,yBAAyB;QACzB,MAAM,wBAAwB,IAAA,yMAAkB,EAAC;QAEjD,mBAAmB;QACnB,MAAM,UAAU,IAAA,4MAAoB;QAEpC,wBAAwB;QACxB,MAAM,eAAe,IAAA,4MAAqB,EAAC;QAE3C,8BAA8B;QAC9B,MAAM,kBAAkB,MAAM,IAAA,+NAAyB,EACrD,cACA,mBACA,uBACA,SACA,aAAa,UAAU;QAGzB,OAAO,oNAAY,CAAC,IAAI,CAAC;YACvB;YACA;YACA;YACA;YACA;YACA;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,oNAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAqC,GAAG;YAAE,QAAQ;QAAI;IAC1F;AACF"}}]
}